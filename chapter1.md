# Глава 1. Power Query меняет всё

## Что такое Power Query?

Power Query - общее название для комплекса инструментов Microsoft, под которым, в зависимости от сферы применения, подразумевается:

* надстройка к Microsoft Excel 2010/2013

* группа инструментов "Get&Transform" \("Получить и преобразовать"\) в Excel 2016

* Query Editor \(Редактор запросов\) в Power BI

* Язык программирования M

* Инструментарий ETL в SSDT и других элементах Azure Common Data Model.

Основная задача Power Query - выполнение функций **ETL** для Microsoft Excel, Power BI и Common Data Model

> **ETL **\(**E**xtract, **T**ransform, **L**oad\) - один из основных процессов в управлении хранилищами данных, который включает в себя **извлечение **данных из внешних источников, их **трансформацию и очистку**, чтобы они соответствовали потребностям аналитической модели, и **загрузку **их в хранилище данных.

Во всех своих ипостасях Power Query, без сомнения, одно из самых важных, ключевых нововведений в набор инструментов аналитика. Можно сказать, это лучшее, что произошло с набором инструментов для анализа данных Microsoft за последние годы.

## Что умеет Power Query?

1. _**Получать данные**_ из большого \(очень большого\) количества разнообразных источников - начиная от текстовых файлов и заканчивая хитрыми API и специфическими базами данных. И не просто получать, а собирать их в одном рабочем пространстве для последующего объединения, комбинирования и прочих манипуляций. Таким образом, вместо десятков разных коннекторов \(разбросанных в разных местах, имеющих каждый свои особенности, выгружающих данные по своему усмотрению\) мы имеем один инструмент для получения и сведения информации в одну аналитическую модель.

2. _**Очищать**_ и преобразовывать данные \(например, разбивать на части или доставать отдельные элементы из HTML-кода, попутно избавляя их от ненужных символов\). _**Трансформировать**_ их в нужный вид \(например, из текста в таблицу\), придавать им нужную форму \(списки, таблицы, записи, и так далее\). _**Агрегировать**_ \(например, группировать и суммировать\). _**Комбинировать**_ данные из разных источников\). Другими словами, трансфигурировать: создавать из разнообразных источников новую сущность - аналитическую модель данных.

3. _**Выгружать**_ данные в аналитический инструмент \(будь то Excel, Power BI или SSAS\) и обеспечивать стабильное _**обновление**_** **данных "в один клик". Действительно, достаточно нажать кнопку Refresh, и Power Query запросит все указанные вами источники данных \(см. п. 1\), проведет все необходимые трансфигурации \(см. п.2\) и выгрузит результат в вашу модель данных.

### В чем же отличие Power Query от других похожих инструментов?

1. Первое и самое главное - **Power Query прост**. В отличие от промышленных ETL-систем, Power Query предназначен для массового пользователя, рядового аналитика. Пользовательский интерфейс интуитивно понятен и обеспечивает простыми нажатиями на кнопки б_**о**_льшую часть необходимых действий в процессе подготовки данных. Практически, редактирование исходного кода созданных запросов нужно только в специфических случаях.

2. _**Легкая переносимость**_. Запросы, созданные в Power Query для Excel, могут быть использованы в Power BI или других инструментах, и наоборот \(за исключением нескольких функций, разработанных специально под тот или иной инструмент\). Достаточно скопировать код запроса в одном инструменте и вставить его в другом, и, в общем-то, всё, запрос будет выполняться.

3. **Расширяемость**. Продвинутые пользователи могут написать собственные функции или даже коннекторы к специфическим источникам данных, и многократно использовать эти функции при помощи инструмента расширений \(extensions\). Или, например, поместить их в вебе и загружать исполняемый код прямо оттуда.

Так вроде бы это всё можно сделать при помощи других инструментов, например, VBA? Наверное, да, но... см. п.1

## Как устроен Power Query?

### Пользовательский интерфейс

В первую очередь, 

### Язык программирования M

В основе Power Query лежит язык программирования M и пользовательский графический интерфейс, обеспечивающий большую часть работы \(иногда его называют скриптовым языком программирования, так как в основном он используется для создания небольших автоматических запросов в Excel или Power BI\). Все значимые действия, совершенные пользователем посредством элементов интерфейса, записываются в программу на языке M, которая затем и исполняется движком Power Query.



